<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLE é†«ç™‚æ•¸æ“šæ¥æ”¶å™¨ - Web é è¦½</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #212121;
        }
        
        .app-header {
            background-color: #2196F3;
            color: white;
            padding: 16px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .app-title {
            font-size: 20px;
            font-weight: 600;
        }
        
        .tab-bar {
            display: flex;
            background-color: white;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .tab {
            flex: 1;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            border-bottom-color: #2196F3;
            color: #2196F3;
        }
        
        .tab:hover {
            background-color: #f5f5f5;
        }
        
        .content {
            padding: 16px;
            min-height: calc(100vh - 120px);
        }
        
        .device-card {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .device-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }
        
        .device-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .device-info {
            display: flex;
            align-items: center;
        }
        
        .device-icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            color: #2196F3;
        }
        
        .device-name {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .device-id {
            font-size: 12px;
            color: #757575;
        }
        
        .device-status {
            text-align: right;
        }
        
        .rssi {
            font-size: 10px;
            font-weight: 500;
        }
        
        .device-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chip {
            padding: 4px 8px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .chip-outlined {
            border: 1px solid #e3f2fd;
            background-color: #e3f2fd;
            color: #1976d2;
        }
        
        .chip-connected {
            background-color: #e8f5e8;
            color: #2e7d32;
        }
        
        .data-card {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #4CAF50;
        }
        
        .data-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .data-type {
            font-size: 16px;
            font-weight: 500;
        }
        
        .timestamp {
            font-size: 12px;
            color: #757575;
        }
        
        .primary-value {
            text-align: center;
            margin: 16px 0;
        }
        
        .value-number {
            font-size: 32px;
            font-weight: 700;
            color: #2196F3;
        }
        
        .value-unit {
            font-size: 16px;
            font-weight: 500;
            color: #757575;
            margin-left: 4px;
        }
        
        .data-details {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
        }
        
        .detail-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .detail-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            color: #757575;
        }
        
        .fab {
            position: fixed;
            bottom: 16px;
            right: 16px;
            width: 56px;
            height: 56px;
            border-radius: 28px;
            background-color: #2196F3;
            color: white;
            border: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.3s;
        }
        
        .fab:hover {
            background-color: #1976D2;
            transform: scale(1.1);
        }
        
        .empty-state {
            text-align: center;
            padding: 64px 32px;
            color: #757575;
        }
        
        .empty-icon {
            font-size: 64px;
            margin-bottom: 16px;
            color: #bdbdbd;
        }
        
        .empty-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .empty-subtitle {
            font-size: 14px;
            line-height: 1.5;
        }
        
        .scanning {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="app-header">
        <div class="app-title">ğŸ©º BLE é†«ç™‚æ•¸æ“šæ¥æ”¶å™¨</div>
    </div>
    
    <div class="tab-bar">
        <div class="tab active" onclick="showTab('devices')">ğŸ“± è¨­å‚™</div>
        <div class="tab" onclick="showTab('data')">ğŸ“Š æ•¸æ“š</div>
    </div>
    
    <div class="content">
        <!-- è¨­å‚™é é¢ -->
        <div id="devices-tab">
            <div id="device-list">
                <!-- è¨­å‚™æœƒå‹•æ…‹æ·»åŠ åˆ°é€™è£¡ -->
            </div>
            
            <div id="empty-devices" class="empty-state">
                <div class="empty-icon">ğŸ”</div>
                <div class="empty-title">æœªç™¼ç¾è¨­å‚™</div>
                <div class="empty-subtitle">é»æ“ŠæƒææŒ‰éˆ•é–‹å§‹æœå°‹é†«ç™‚è¨­å‚™</div>
            </div>
        </div>
        
        <!-- æ•¸æ“šé é¢ -->
        <div id="data-tab" class="hidden">
            <div id="data-list">
                <!-- æ•¸æ“šæœƒå‹•æ…‹æ·»åŠ åˆ°é€™è£¡ -->
            </div>
            
            <div id="empty-data" class="empty-state">
                <div class="empty-icon">ğŸ“ˆ</div>
                <div class="empty-title">æš«ç„¡æ•¸æ“š</div>
                <div class="empty-subtitle">é€£æ¥é†«ç™‚è¨­å‚™ä¸¦é€²è¡Œæ¸¬é‡ä»¥æŸ¥çœ‹æ•¸æ“š</div>
            </div>
        </div>
    </div>
    
    <button class="fab" id="scan-btn" onclick="toggleScan()">ğŸ”</button>
    
    <script>
        let isScanning = false;
        let devices = [];
        let measurements = [];
        let currentTab = 'devices';
        
        // æ¨¡æ“¬è¨­å‚™æ•¸æ“š
        const mockDevices = [
            {
                id: 'device-001',
                name: 'FORA IR40',
                type: 'thermometer',
                rssi: -45,
                connected: false
            },
            {
                id: 'device-002', 
                name: 'BP Monitor',
                type: 'blood-pressure',
                rssi: -67,
                connected: false
            }
        ];
        
        // æ¨¡æ“¬æ¸¬é‡æ•¸æ“š
        const mockMeasurements = [
            {
                id: 'measure-001',
                deviceId: 'device-001',
                type: 'temperature',
                value: 36.4,
                unit: 'C',
                timestamp: new Date(),
                valid: true
            },
            {
                id: 'measure-002',
                deviceId: 'device-002', 
                type: 'blood-pressure',
                systolic: 120,
                diastolic: 80,
                heartRate: 72,
                timestamp: new Date(Date.now() - 300000),
                valid: true
            }
        ];
        
        function showTab(tab) {
            currentTab = tab;
            
            // æ›´æ–°æ¨™ç±¤æ¨£å¼
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[onclick="showTab('${tab}')"]`).classList.add('active');
            
            // é¡¯ç¤ºå°æ‡‰å…§å®¹
            document.getElementById('devices-tab').classList.toggle('hidden', tab !== 'devices');
            document.getElementById('data-tab').classList.toggle('hidden', tab !== 'data');
            
            // æ›´æ–° FAB
            const fab = document.getElementById('scan-btn');
            if (tab === 'devices') {
                fab.style.display = 'flex';
                fab.innerHTML = isScanning ? 'â¹ï¸' : 'ğŸ”';
            } else {
                fab.style.display = 'none';
            }
        }
        
        function toggleScan() {
            isScanning = !isScanning;
            const fab = document.getElementById('scan-btn');
            
            if (isScanning) {
                fab.innerHTML = 'â¹ï¸';
                fab.classList.add('scanning');
                startScan();
            } else {
                fab.innerHTML = 'ğŸ”';
                fab.classList.remove('scanning');
                stopScan();
            }
        }
        
        function startScan() {
            devices = [];
            renderDevices();
            
            // æ¨¡æ“¬è¨­å‚™ç™¼ç¾
            setTimeout(() => {
                if (isScanning) {
                    devices.push(mockDevices[0]);
                    renderDevices();
                }
            }, 1000);
            
            setTimeout(() => {
                if (isScanning) {
                    devices.push(mockDevices[1]);
                    renderDevices();
                }
            }, 2500);
            
            // è‡ªå‹•åœæ­¢æƒæ
            setTimeout(() => {
                if (isScanning) {
                    toggleScan();
                }
            }, 10000);
        }
        
        function stopScan() {
            // åœæ­¢æƒæé‚è¼¯
        }
        
        function connectDevice(deviceId) {
            const device = devices.find(d => d.id === deviceId);
            if (device) {
                device.connected = !device.connected;
                renderDevices();
                
                if (device.connected) {
                    // æ¨¡æ“¬æ•¸æ“šæ¥æ”¶
                    setTimeout(() => {
                        if (device.type === 'thermometer') {
                            measurements.unshift({
                                ...mockMeasurements[0],
                                id: 'measure-' + Date.now(),
                                timestamp: new Date()
                            });
                        } else {
                            measurements.unshift({
                                ...mockMeasurements[1],
                                id: 'measure-' + Date.now(),
                                timestamp: new Date()
                            });
                        }
                        renderMeasurements();
                        showTab('data');
                    }, 2000);
                }
            }
        }
        
        function renderDevices() {
            const container = document.getElementById('device-list');
            const empty = document.getElementById('empty-devices');
            
            if (devices.length === 0) {
                container.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            container.innerHTML = devices.map(device => `
                <div class="device-card" onclick="connectDevice('${device.id}')">
                    <div class="device-header">
                        <div class="device-info">
                            <div class="device-icon">${device.type === 'thermometer' ? 'ğŸŒ¡ï¸' : 'â¤ï¸'}</div>
                            <div>
                                <div class="device-name">${device.name}</div>
                                <div class="device-id">ID: ${device.id.substring(0, 8)}...</div>
                            </div>
                        </div>
                        <div class="device-status">
                            <div style="color: ${device.rssi > -50 ? '#4CAF50' : device.rssi > -70 ? '#FF9800' : '#F44336'}">
                                ğŸ“¶
                            </div>
                            <div class="rssi" style="color: ${device.rssi > -50 ? '#4CAF50' : device.rssi > -70 ? '#FF9800' : '#F44336'}">
                                ${device.rssi} dBm
                            </div>
                        </div>
                    </div>
                    <div class="device-footer">
                        <div class="chip chip-outlined">
                            ${device.type === 'thermometer' ? 'é«”æº«è¨ˆ' : 'è¡€å£“è¨ˆ'}
                        </div>
                        ${device.connected ? '<div class="chip chip-connected">å·²é€£æ¥</div>' : ''}
                    </div>
                </div>
            `).join('');
        }
        
        function renderMeasurements() {
            const container = document.getElementById('data-list');
            const empty = document.getElementById('empty-data');
            
            if (measurements.length === 0) {
                container.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            container.innerHTML = measurements.map(measurement => {
                if (measurement.type === 'temperature') {
                    return `
                        <div class="data-card">
                            <div class="data-header">
                                <div>
                                    <div class="data-type">ğŸŒ¡ï¸ é«”æº«è¨ˆ</div>
                                    <div class="timestamp">${measurement.timestamp.toLocaleString('zh-TW')}</div>
                                </div>
                                <div class="chip" style="background-color: ${measurement.valid ? '#E8F5E8' : '#FFEBEE'}; color: ${measurement.valid ? '#2E7D32' : '#C62828'}">
                                    ${measurement.valid ? 'æœ‰æ•ˆ' : 'ç„¡æ•ˆ'}
                                </div>
                            </div>
                            <div class="primary-value">
                                <span class="value-number">${measurement.value}</span>
                                <span class="value-unit">Â°${measurement.unit}</span>
                            </div>
                            <div class="data-details">
                                <div class="detail-row">
                                    <div class="detail-icon">ğŸŒ¡ï¸</div>
                                    <div>é«”æº«: ${measurement.value}Â°${measurement.unit}</div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">ğŸ“Š</div>
                                    <div>ç¯„åœ: ${measurement.value >= 36.1 && measurement.value <= 37.2 ? 'æ­£å¸¸' : 'ç•°å¸¸'}</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    return `
                        <div class="data-card">
                            <div class="data-header">
                                <div>
                                    <div class="data-type">â¤ï¸ è¡€å£“è¨ˆ</div>
                                    <div class="timestamp">${measurement.timestamp.toLocaleString('zh-TW')}</div>
                                </div>
                                <div class="chip" style="background-color: ${measurement.valid ? '#E8F5E8' : '#FFEBEE'}; color: ${measurement.valid ? '#2E7D32' : '#C62828'}">
                                    ${measurement.valid ? 'æœ‰æ•ˆ' : 'ç„¡æ•ˆ'}
                                </div>
                            </div>
                            <div class="primary-value">
                                <span class="value-number">${measurement.systolic}/${measurement.diastolic}</span>
                                <span class="value-unit">mmHg</span>
                            </div>
                            <div class="data-details">
                                <div class="detail-row">
                                    <div class="detail-icon">â¤ï¸</div>
                                    <div>æ”¶ç¸®å£“: ${measurement.systolic} mmHg</div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">ğŸ’™</div>
                                    <div>èˆ’å¼µå£“: ${measurement.diastolic} mmHg</div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">ğŸ’“</div>
                                    <div>å¿ƒç‡: ${measurement.heartRate} bpm</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }).join('');
        }
        
        // åˆå§‹åŒ–
        renderDevices();
        renderMeasurements();
    </script>
</body>
</html>